# 🎬 얼굴 인식 기반 디지털 취약 계층을 위한 맞춤형 영화 예매 키오스크
「2022 SCH AI·SW Festival」 우수상 수상작
## 🗓️ 프로젝트 기간
2022/10/20 ~ 2022/11/5
## 🧑‍💻 프로젝트 인원
|<img src="https://avatars.githubusercontent.com/u/121855323?v=4" width="150" height="150"/>|<img src="https://avatars.githubusercontent.com/u/87566401?v=4" width="150" height="150"/>|
|:-:|:-:|
|최정안<br/>[@jeongan-choi](https://github.com/jeongan-choi)|조유빈<br/>[@YuBin-OuO](https://github.com/YuBin-OuO)|
## 👤 내 역할
- Java로 안드로이드 키오스크 어플리케이션 개발
- UI/UX 디자인 및 구현
- OpenCV 활용 얼굴 인식 기능 구현
- 캠(서버) - 키오스크 어플리케이션(클라이언트) 간 TCP/IP 소켓 통신 구현
## 🛠️ 사용 언어 및 기술
- 키오스크 어플리케이션  
![JAVA](https://img.shields.io/badge/Java-007396?style=flat-square&logo=data:image/svg%2bxml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KDTwhLS0gVXBsb2FkZWQgdG86IFNWRyBSZXBvLCB3d3cuc3ZncmVwby5jb20sIFRyYW5zZm9ybWVkIGJ5OiBTVkcgUmVwbyBNaXhlciBUb29scyAtLT4KPHN2ZyB3aWR0aD0iMTUwcHgiIGhlaWdodD0iMTUwcHgiIHZpZXdCb3g9IjAgMCAzMi4wMCAzMi4wMCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiNmZmZmZmYiIHN0cm9rZS13aWR0aD0iMC4yNTYiPgoNPGcgaWQ9IlNWR1JlcG9fYmdDYXJyaWVyIiBzdHJva2Utd2lkdGg9IjAiLz4KDTxnIGlkPSJTVkdSZXBvX3RyYWNlckNhcnJpZXIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgoNPGcgaWQ9IlNWR1JlcG9faWNvbkNhcnJpZXIiPiA8cGF0aCBmaWxsPSIjZmZmZmZmIiBkPSJNMTIuNTU3IDIzLjIyYzAgMC0wLjk4MiAwLjU3MSAwLjY5OSAwLjc2NSAyLjAzNyAwLjIzMiAzLjA3OSAwLjE5OSA1LjMyNC0wLjIyNiAwIDAgMC41OSAwLjM3IDEuNDE1IDAuNjkxLTUuMDMzIDIuMTU3LTExLjM5LTAuMTI1LTcuNDM3LTEuMjN6TTExLjk0MiAyMC40MDVjMCAwLTEuMTAyIDAuODE2IDAuNTgxIDAuOTkgMi4xNzYgMC4yMjQgMy44OTUgMC4yNDMgNi44NjktMC4zMyAwIDAgMC40MTEgMC40MTcgMS4wNTggMC42NDUtNi4wODUgMS43NzktMTIuODYzIDAuMTQtOC41MDgtMS4zMDV6TTE3LjEyNyAxNS42M2MxLjI0IDEuNDI4LTAuMzI2IDIuNzEzLTAuMzI2IDIuNzEzczMuMTQ5LTEuNjI1IDEuNzAzLTMuNjYxYy0xLjM1MS0xLjg5OC0yLjM4Ni0yLjg0MSAzLjIyMS02LjA5MyAwIDAtOC44MDEgMi4xOTgtNC41OTggNy4wNDJ6TTIzLjc4MyAyNS4zMDJjMCAwIDAuNzI3IDAuNTk5LTAuODAxIDEuMDYyLTIuOTA1IDAuODgtMTIuMDkxIDEuMTQ2LTE0LjY0MyAwLjAzNS0wLjkxNy0wLjM5OSAwLjgwMy0wLjk1MyAxLjM0NC0xLjA2OSAwLjU2NC0wLjEyMiAwLjg4Ny0wLjEgMC44ODctMC4xLTEuMDIwLTAuNzE5LTYuNTk0IDEuNDExLTIuODMxIDIuMDIxIDEwLjI2MiAxLjY2NCAxOC43MDYtMC43NDkgMTYuMDQ0LTEuOTV6TTEzLjAyOSAxNy40ODljMCAwLTQuNjczIDEuMTEtMS42NTUgMS41MTMgMS4yNzQgMC4xNzEgMy44MTQgMC4xMzIgNi4xODEtMC4wNjYgMS45MzQtMC4xNjMgMy44NzYtMC41MSAzLjg3Ni0wLjUxcy0wLjY4MiAwLjI5Mi0xLjE3NSAwLjYyOWMtNC43NDUgMS4yNDgtMTMuOTExIDAuNjY3LTExLjI3Mi0wLjYwOSAyLjIzMi0xLjA3OSA0LjA0Ni0wLjk1NiA0LjA0Ni0wLjk1NnpNMjEuNDEyIDIyLjE3NGM0LjgyNC0yLjUwNiAyLjU5My00LjkxNSAxLjAzNy00LjU5MS0wLjM4MiAwLjA3OS0wLjU1MiAwLjE0OC0wLjU1MiAwLjE0OHMwLjE0Mi0wLjIyMiAwLjQxMi0wLjMxOGMzLjA3OS0xLjA4MyA1LjQ0OCAzLjE5My0wLjk5NCA0Ljg4Ny0wIDAgMC4wNzUtMC4wNjcgMC4wOTctMC4xMjZ6TTE4LjUwMyAzLjMzN2MwIDAgMi42NzEgMi42NzItMi41MzQgNi43ODEtNC4xNzQgMy4yOTYtMC45NTIgNS4xNzYtMC4wMDIgNy4zMjMtMi40MzYtMi4xOTgtNC4yMjQtNC4xMzMtMy4wMjUtNS45MzQgMS43NjEtMi42NDQgNi42MzgtMy45MjUgNS41Ni04LjE3ek0xMy41MDMgMjguOTY2YzQuNjMgMC4yOTYgMTEuNzQtMC4xNjQgMTEuOTA4LTIuMzU1IDAgMC0wLjMyNCAwLjgzMS0zLjgyNiAxLjQ5LTMuOTUyIDAuNzQ0LTguODI2IDAuNjU3LTExLjcxNiAwLjE4IDAgMCAwLjU5MiAwLjQ5IDMuNjM1IDAuNjg1eiIvPiA8L2c+Cg08L3N2Zz4=) <img src="https://img.shields.io/badge/Android Studio-3DDC84?style=flat-square&logo=Android Studio&logoColor=white"/>
- 얼굴 인식 및 성별·연령 분류 모델  
<img src="https://img.shields.io/badge/Python-3776AB?style=flat-square&logo=python&logoColor=white"/> <img src="https://img.shields.io/badge/OpenCV-27338e?style=flat-square&logo=OpenCV&logoColor=white"/>
- 협업  
  <img src="https://img.shields.io/badge/Notion-000000?style=flat-square&logo=notion&logoColor=white"/>  

## 💫 설명
### 프로젝트 배경 🖼️
현재의 영화 예매 키오스크는 복잡한 사용 방법과 작은 글씨로 고령층과 같은 디지털 취약 계층에게 어려움을 주고 있다는 사실을 파악  
&emsp;→ 이를 개선하고자 맞춤형 키오스크를 제작
### 개요 📌 
- 기존의 영화 예매 키오스크에 실시간 영상 처리 및 분석 기능을 제공하는 OpenCV를 활용한 얼굴 인식 기능을 추가하여 사용자의 나이 및 성별을 파악
- 예측된 나이가 40대 이상일 경우 시니어용 화면으로 전환이 되는데, 이는 일반 화면에 비하여 확대된 글자와 직관적으로 파악할 수 있는 단순한 화면으로 구성
- 영화 소비자 행태 조사(한국 영화 진흥 위원회)의 나이와 성별에 따른 선호 장르를 영화 추천 서비스에 활용
PC의 서버에서 딥러닝 모델을 이용해 추출한 나이와 성별 데이터를 소켓 통신을 통해 클라이언트인 키오스크로 보냄  
&emsp;→ 이 데이터를 기반으로 영화 추천 서비스와 맞춤 화면을 제공
### UI 🎨 
일반 화면은 한 화면에 여러 정보들이 집약되어 있고 인원 선택 시 한 눈에 파악하기 어려워 혼란을 줄 수 있음  
&emsp;→ 이를 지양하고자 시니어용 화면에는 한 화면당 하나의 선택만을 할 수 있도록 구성하여 (최대한 적은 정보를 담아) 혼란을 최소화할 수 있도록 함

<details>
  <summary><b>UI 프로토타입</b></summary>
    <img src="https://github.com/user-attachments/assets/e64c4392-54bc-4104-893d-09cc566f8937">
    <img src="https://github.com/user-attachments/assets/3babcfd0-f904-4db4-998e-c46b046d3d83">
</details>

### 시연 영상 📹
[![Video Label](https://ifh.cc/g/9RRtSf.jpg)](https://youtu.be/b0kLY3HeHrA?t=0s)

### 기술 설명 🔧 
<details>
<summary>📱 안드로이드 어플리케이션</summary>

- 대부분의 키오스크 하드웨어가 안드로이드 보드로 제작됨
- 호환성이 좋고 낮은 사양에서도 잘 동작

</details>

<details>
<summary>🔌 TCP/IP 소켓 통신</summary>

소켓은 응용프로그램에서 TCP/IP를 이용하는 창구 역할을 하며, 두 프로그램이 네트워크를 통해 서로 통신을 수행할 수 있도록 양쪽에서 생성되는 링크의 단자. 두 소켓이 연결되면 서로 다른 프로그램이 서로 데이터를 전달할 수 있게 됨
1. 먼저 기다리는 측을 Server라고 하며, Server에서는 Port를 열고 Client의 접속을 기다림
2. 접속하는 측을 Client라고 하며, Server의 IP와 Port에 접속하여 통신이 연결됨
3. Server와 Client 간의 통신은 Send, Receive의 형태로 주고받음
4. 통신이 끝나면 close()로 접속을 끊음

*IP: 인터넷 상에서 사용하는 주소 체계*  
*Port: 프로세스를 구분하기 위해 사용하는 번호로, IP 주소가 가리키는 PC에 접속할 수 있는 통로(채널)*  

**Flask/Django와 같은 웹 프레임워크 대신 채택한 이유**  
1) 실시간 통신 요구  
소켓 통신은 HTTP 기반의 요청-응답 모델보다 지연 시간이 적음 → 사용자 경험 향상
2) 경량화
본 키오스크 어플리케이션은 단일 목적을 위해 설계된 경량 어플리케이션이기 때문에, 웹 프레임워크보다 소켓 통신을 사용하는 것이 더 단순하고 효율적일 것이라 판단

</details>

<details>
<summary>📷 OpenCV</summary>

실시간 처리에 중점을 두고 설계되어 빠른 속도와 효율성을 자랑하며, 이미지·비디오를 처리하는 동시에 분석 가능

**CNN 기반 신경망 모델**
- 얼굴 탐지를 통해 **예측된 얼굴의 위치 (경계 상자)를 기준**으로 이미지를 추출한 뒤, 성별 또는 연령 데이터가 학습된 분류기와 비교하여 가장 근접한 데이터를 판별 
- 키오스크의 특성상 **판별 속도**가 정확도보다 더 중요하다고 판단. 이에 따라 성능이 우수한 DeepFace나 FaceNet 모델 대신, **Caffe 프레임워크**를 사용하여 설계하고 학습한 판별 속도가 빠른 모델을 채택. 그 결과, 판별 속도가 빠르면서도 성능도 적절한 키오스크 어플리케이션을 개발할 수 있었음

  1) **readNetFromCaffe**함수로 연령과 성별 예측 모델을 불러옴
  2) 8가지 연령대 중 하나로 분류 → softmax 유형의 최종 출력 레이어
  * Adience 데이터셋으로 훈련: 8가지 연령대((0 – 2), (4 – 6), (8 – 12), (15 – 20), (25 – 32), (38 – 43), (48 – 53), (60 – 100))의 총 2,284명의 피사체에 대한 총 26,580장의 사진이 있으며 크기는 약 1GB

**각 파일에 대한 설명**
- 얼굴 탐지기  
  - opencv_face_detector.pbtxt : 얼굴을 감지 하기 위한 파일. 텍스트 형식  
  - opencv_face_detector_uint8.pb : 얼굴을 감지 하기 위한 파일. 이진 형식  
  
- 연령 분류기  
  - age_deploy.prototxt : 연령에 대한 네트워크 구성  
  - age_net.caffemodel : 연령에 대한 레이어 매개 변수의 내부 상태를 정의  
  
- 성별 분류기  
  - gender_deploy.prototxt :성별에 대한 네트워크 구성  
  - gender_net.caffemodel : 성별에 대한 레이어 매개 변수의 내부 상태를 정의

.pb: protobuf (프로토콜 버퍼) -> 그래프 정의와 모델의 훈련된 가중치 보유. 이것으로 훈련된 모델을 실행할 수 있음. 바이너리 형식의 protobuf 보유  
.pttxt: 텍스트 형식으로 protobuf 보유. TensorFlow 파일. 연령 및 성별 탐지에서 네트워크 구성 설명  
.caffemodel: 개층 매개변수의 내부 상태 정의  

</details>


### 기대 효과 🌟
- 일상화가 된 무인화 기기로부터 디지털 취약 계층의 키오스크 공포증 해소에 도움 줄 것
- 직원들의 인력 낭비 감소
- 영화관 비롯해 카페 등 다른 분야의 서비스에도 접목할 수 있을 것
- 나이, 성별 등 안전하게 익명화된 정보를 추가 작업 없이 수집 및 분석 가능할 것
  
## ✊ 피드백 및 개선 방향
- 키워드 선택하면 영화 추천해주는 기능 추가되면 좋을듯
- 연관성이 중요 → 이전 화면에서 선택했던 것들 인지할 수 있도록 (지금까지 선택한 내용들 작은 창에 보여주는 등)
- 고령층은 화면 보고 하는 것보다 면대면으로 하는 걸 더 편해 함 → 음성인식 기능 추가
- 사용자의 예매 내역에 따라 정보를 DB화 시켜 관리: 영화 추천할 때 단순히 지난 성별/연령별 통계 자료를 이용한 하드코딩식 추천이 아닌 지금까지 예매한 사람들의 데이터를 DB에 모아 연동해 성별/연령별로 가장 많이 예매한 영화를 추천해주거나 AI로 추천해주거나 하면 추천 성능이 더 좋아질듯
  
